---
description: é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ - PRä½œæˆã€ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã€ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
globs: ["**/*"]
alwaysApply: false
---

# é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ & ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

## æ©Ÿèƒ½é–‹ç™ºãƒ•ãƒ­ãƒ¼

### 1. ãƒ–ãƒ©ãƒ³ãƒä½œæˆï¼ˆç¾åœ¨ã®çŠ¶æ³ï¼‰
```bash
# æ–°æ©Ÿèƒ½é–‹ç™ºé–‹å§‹ï¼ˆrefactorãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ï¼‰
git checkout refactor
git pull origin refactor
git checkout -b feature/log-collection-improvement

# å°†æ¥çš„ã«ã¯developãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Œäº†å¾Œï¼‰
# git checkout develop
# git pull origin develop
# git checkout -b feature/new-dashboard-feature
```

### 2. é–‹ç™ºä½œæ¥­
- å°ã•ãªã‚³ãƒŸãƒƒãƒˆå˜ä½ã§ä½œæ¥­
- å„ã‚³ãƒŸãƒƒãƒˆã¯Conventional Commitså½¢å¼ã§è¨˜è¿°
- æ©Ÿèƒ½ã”ã¨ã«ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
- **ğŸš¨ é‡è¦**: å‹•ä½œç¢ºèªå‰ã«commitã€PRã‚’ä½œæˆã—ãªã„
  - å¿…ãšãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã¾ãŸã¯Kubernetesç’°å¢ƒã§å‹•ä½œç¢ºèªã‚’å®Ÿæ–½
  - å‹•ä½œç¢ºèªå®Œäº†å¾Œã«commitã€PRã‚’ä½œæˆ

### 3. PRä½œæˆï¼ˆè‡ªå‹•åŒ–æ¨å¥¨ï¼‰
```bash
# è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
./scripts/create-pr.sh -t [ãƒã‚±ãƒƒãƒˆç•ªå·] -n [æ©Ÿèƒ½å]

# ä¾‹: ãƒã‚±ãƒƒãƒˆç•ªå·123ã€æ©Ÿèƒ½ålog-collection-improvement
./scripts/create-pr.sh -t 123 -n log-collection-improvement

# æ‰‹å‹•ã§PRä½œæˆã™ã‚‹å ´åˆ
gh pr create --title "[#123] feat: log-collection-improvement" \
  --body-file PR_TEMPLATE.md \
  --base refactor \
  --head $(git branch --show-current)
```

### 3.1 PRä½œæˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```markdown
## æ¦‚è¦
[å¤‰æ›´å†…å®¹ã®æ¦‚è¦ã‚’è¨˜è¿°]

## å¤‰æ›´å†…å®¹
- [ ] æ–°æ©Ÿèƒ½è¿½åŠ 
- [ ] ãƒã‚°ä¿®æ­£
- [ ] ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

## ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¿½åŠ 
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] æ‰‹å‹•ãƒ†ã‚¹ãƒˆå®Ÿæ–½

## å½±éŸ¿ç¯„å›²
[å¤‰æ›´ã«ã‚ˆã‚‹å½±éŸ¿ç¯„å›²ã‚’è¨˜è¿°]

## é–¢é€£ãƒã‚±ãƒƒãƒˆ
Closes #[ãƒã‚±ãƒƒãƒˆç•ªå·]
```

## ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ‰‹é †

### è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
./scripts/run-tests.sh

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã®ã¿ï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãï¼‰
./scripts/run-tests.sh -b -c

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã®ã¿ï¼ˆè©³ç´°å‡ºåŠ›ï¼‰
./scripts/run-tests.sh -f -v

# ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
./scripts/run-tests.sh -h
```

### æ‰‹å‹•å®Ÿè¡Œ

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆPythonï¼‰
```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt
pip install -r requirements_test.txt

# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pytest tests/ -v --cov=./ --cov-report=html

# Lintå®Ÿè¡Œ
pylint backend/
flake8 backend/
mypy backend/
```

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆNext.jsï¼‰
```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test

# Lint & Format
npm run lint
npm run format

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build
```

#### Dockerç’°å¢ƒ
```bash
# é–‹ç™ºç’°å¢ƒèµ·å‹•
docker-compose -f docker-compose.yml up -d

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
docker-compose exec backend pytest
docker-compose exec frontend npm test

# ãƒ­ã‚°ç¢ºèª
docker-compose logs -f
```

## ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### é–‹ç™ºç’°å¢ƒï¼ˆç¾åœ¨ã®çŠ¶æ³ï¼‰
```bash
# refactorãƒ–ãƒ©ãƒ³ãƒã®ãƒ‡ãƒ—ãƒ­ã‚¤
git checkout refactor
git pull origin refactor
docker-compose -f docker-compose.yml up -d --build

# å°†æ¥çš„ã«ã¯developãƒ–ãƒ©ãƒ³ãƒã®ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Œäº†å¾Œï¼‰
# git checkout develop
# git pull origin develop
# docker-compose -f docker-compose.yml up -d --build
```

### æœ¬ç•ªç’°å¢ƒ
```bash
# mainãƒ–ãƒ©ãƒ³ãƒã®ãƒ‡ãƒ—ãƒ­ã‚¤
git checkout main
git pull origin main
git tag v1.0.0
git push origin v1.0.0

# Kubernetesãƒ‡ãƒ—ãƒ­ã‚¤
kubectl apply -f k8s/
```

## ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æ©Ÿèƒ½æ€§
- [ ] è¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯é©åˆ‡ã‹
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å•é¡Œã¯ãªã„ã‹

### ã‚³ãƒ¼ãƒ‰å“è³ª
- [ ] å¯èª­æ€§ã¯é«˜ã„ã‹
- [ ] å‘½åã¯é©åˆ‡ã‹
- [ ] é‡è¤‡ã‚³ãƒ¼ãƒ‰ã¯ãªã„ã‹

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- [ ] èªè¨¼ãƒ»èªå¯ã¯é©åˆ‡ã‹
- [ ] å…¥åŠ›å€¤æ¤œè¨¼ã¯ã‚ã‚‹ã‹
- [ ] æ©Ÿå¯†æƒ…å ±ã®æ¼æ´©ãƒªã‚¹ã‚¯ã¯ãªã„ã‹

### ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã¯ååˆ†ã‹
- [ ] ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã¯è€ƒæ…®ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆã¯é€šã‚‹ã‹

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### ãƒ–ãƒ©ãƒ³ãƒç«¶åˆ
```bash
git checkout feature/your-branch
git rebase refactor
# ç«¶åˆè§£æ±ºå¾Œ
git rebase --continue
```

#### ãƒ†ã‚¹ãƒˆå¤±æ•—
```bash
# ç’°å¢ƒãƒªã‚»ãƒƒãƒˆ
docker-compose down -v
docker-compose up -d --build

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
pytest --cache-clear
npm run clean
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤å¤±æ•—
```bash
# å‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
git checkout [å‰ã®ã‚¿ã‚°]
kubectl rollout undo deployment/backend
```

## åˆ¶é™äº‹é …ã¨ç¦æ­¢è¡Œç‚º

### ãƒ–ãƒ©ãƒ³ãƒæ“ä½œã®åˆ¶é™
```bash
# âŒ ç¦æ­¢: ç›´æ¥ã‚³ãƒŸãƒƒãƒˆ
git checkout develop
git add .
git commit -m "fix: bug fix"  # ç¦æ­¢

# âŒ ç¦æ­¢: mainãƒ–ãƒ©ãƒ³ãƒã§ã®push
git checkout main
git push origin main  # ç¦æ­¢

# âœ… æ­£ã—ã„æ‰‹é †: PRçµŒç”±
git checkout feature/new-feature
git add .
git commit -m "feat: new feature implementation"
git push origin feature/new-feature
# ãã®å¾ŒPRã‚’ä½œæˆ
```

### ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®åˆ¶é™
```bash
# âŒ ç¦æ­¢: éæ­£å¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
git commit -m "test"
git commit -m "tmp"
git commit -m "wip"
git commit -m "fix"

# âœ… æ­£ã—ã„: Conventional Commitså½¢å¼
git commit -m "feat: ãƒ­ã‚°åé›†æ©Ÿèƒ½ã®è¿½åŠ "
git commit -m "fix: Elasticsearchæ¥ç¶šã‚¨ãƒ©ãƒ¼ã®ä¿®æ­£"
git commit -m "docs: READMEã®æ›´æ–°"
git commit -m "refactor: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šå‡¦ç†ã‚’å…±é€šåŒ–"
```

### commit/PRä½œæˆã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°åˆ¶é™
```bash
# âŒ ç¦æ­¢: å‹•ä½œç¢ºèªå‰ã«commitã€PRä½œæˆ
# å®Ÿè£…å®Œäº† â†’ ã™ãã«commit â†’ PRä½œæˆ ï¼ˆNGï¼ï¼‰

# âœ… æ­£ã—ã„: å‹•ä½œç¢ºèªå¾Œã«commitã€PRä½œæˆ
# 1. å®Ÿè£…å®Œäº†
# 2. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å‹•ä½œç¢ºèª
# 3. Kubernetesç’°å¢ƒã§å‹•ä½œç¢ºèªï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
# 4. å‹•ä½œç¢ºèªOK â†’ commit
# 5. PRä½œæˆ

# ä¾‹: Syslogæ©Ÿèƒ½ã®å ´åˆ
# 1. ã‚³ãƒ¼ãƒ‰å®Ÿè£…
# 2. docker-compose up ã§å‹•ä½œç¢ºèª
# 3. å®Ÿéš›ã«Syslogæ¤œç´¢ã‚’ãƒ†ã‚¹ãƒˆ
# 4. æœŸå¾…é€šã‚Šã®å‹•ä½œã‚’ç¢ºèª
# 5. git commit -m "feat: Syslogã‚¯ãƒ©ã‚¹ã‚¿åˆ¤åˆ¥æ©Ÿèƒ½ã®å®Ÿè£…"
# 6. git push & PRä½œæˆ
```

**ç†ç”±**: 
- å‹•ä½œã—ãªã„ã‚³ãƒ¼ãƒ‰ãŒPRã«å«ã¾ã‚Œã‚‹ã“ã¨ã‚’é˜²ã
- CIã®ç„¡é§„ãªå®Ÿè¡Œã‚’å‰Šæ¸›
- ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã®æ™‚é–“ã‚’ç¯€ç´„
- å“è³ªã®é«˜ã„PRã‚’ç¶­æŒ

### é–‹ç™ºä½œæ¥­ã®åˆ¶é™
```bash
# âŒ ç¦æ­¢: blogãƒ•ã‚©ãƒ«ãƒ€ã§ã®ç›´æ¥ç·¨é›†
cd /home/nutanix/konchangakita/blog-loghoi/blog/20241221
# ã“ã“ã§ã®ç·¨é›†ã¯ç¦æ­¢

# âœ… æ­£ã—ã„: ongoingãƒ•ã‚©ãƒ«ãƒ€ã§ã®é–‹ç™º
cd /home/nutanix/konchangakita/blog-loghoi/ongoing
# ã“ã“ã§æ–°ã—ã„æ©Ÿèƒ½ã‚„ä¿®æ­£ã‚’é–‹ç™º

# âœ… æ­£ã—ã„: å®Œäº†å¾Œã®ç§»å‹•æ‰‹é †
# 1. ongoing/ã§é–‹ç™ºå®Œäº†
# 2. ãƒ†ã‚¹ãƒˆãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
# 3. blog/YYYYMMDD/ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•
```

### ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆãƒ«ãƒ¼ãƒ«
- **`ongoing/`**: ç¾åœ¨é–‹ç™ºä¸­ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰
  - `backend/`: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™º
  - `frontend/`: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º
  - `shared/`: å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒª
  - `tests/`: ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
  - `k8s/`: Kubernetesè¨­å®š
  - `docs/`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **`blog/`**: éå»ã®ãƒ–ãƒ­ã‚°è¨˜äº‹å¯¾å¿œå±¥æ­´
  - ç›´æ¥ç·¨é›†ç¦æ­¢
  - å®Œäº†ã—ãŸæ©Ÿèƒ½ã®ã¿ç§»å‹•å¯èƒ½
  - æ—¥ä»˜ãƒ•ã‚©ãƒ«ãƒ€å½¢å¼ï¼ˆYYYYMMDDï¼‰

### ä¾‹å¤–å‡¦ç†
- ç·Šæ€¥æ™‚ï¼ˆHotfixï¼‰ã®ã¿ã€é©åˆ‡ãªæ‰‹é †ã«å¾“ã£ã¦mainãƒ–ãƒ©ãƒ³ãƒã‚’æ“ä½œå¯èƒ½
- ã™ã¹ã¦ã®ä¾‹å¤–æ“ä½œã¯äº‹å‰æ‰¿èªãŒå¿…è¦
- ä¾‹å¤–æ“ä½œå¾Œã¯å¿…ãšäº‹å¾Œãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½
- `blog/`ãƒ•ã‚©ãƒ«ãƒ€ã®ä¿®æ­£ãŒå¿…è¦ãªå ´åˆã‚‚äº‹å‰æ‰¿èªãŒå¿…è¦

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç¢ºèª
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“
- CPUä½¿ç”¨ç‡
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ•°

### ãƒ­ã‚°ç¢ºèª
```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°
kubectl logs -f deployment/backend

# Elasticsearchãƒ­ã‚°
docker-compose logs -f elastic
```